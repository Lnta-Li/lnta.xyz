代码改写要求如下：
1.使用链式思考推理方法找到用户需求的核心问题，并制定逐步修复计划；
2.使用最精简和逻辑条理最清晰的方式编写代码，不要添加可能有效但非必要的代码，使最终的代码简洁高效、逻辑性强、便于维护；
3.请仔细阅读上下文以及可能相关的文件内容，确保新增或修改的部分不会影响到其他正常的功能，或与其他功能、样式产生冲突；
4.请不要修改其他完全无关的代码内容，除非你有明确的理由和目的；
5.如果没有特别说明，默认对每一部分的代码注释，注释全部使用中文；
6.如果问题很复杂需要分步骤执行，请在根目录的/工作进度.md文档里规划执行步骤，为将来的工作提供完整的上下文，每完成一个步骤，在具体的步骤中打勾，并且补充记录做了哪些具体工作，以及更新下一步计划。